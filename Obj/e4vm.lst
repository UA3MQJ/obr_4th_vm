                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.9.3 #11378 (MINGW32)
                              4 ;--------------------------------------------------------
                              5 	.module e4vm
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _main
                             12 	.globl _e4vm_utils__init
                             13 	.globl _e4vm_utils_init
                             14 	.globl _e4vm_utils_add_op_from_string
                             15 	.globl _e4vm_utils_add_op
                             16 	.globl _e4vm_utils_add_core_word
                             17 	.globl _e4vm_core__init
                             18 	.globl _e4vm_core_do_next
                             19 	.globl _e4vm_core_do_list
                             20 	.globl _e4vm_core_add_core_words
                             21 	.globl _e4vm_type__init
                             22 	.globl _Basic_Quit_IM1
                             23 	.globl _Basic_PAUSE_EI
                             24 	.globl _Console_Clear_COMPACT
                             25 	.globl _Console_WriteStr_C_COMPACT
                             26 	.globl _Console_WriteLn_COMPACT
                             27 	.globl _memcpy
                             28 ;--------------------------------------------------------
                             29 ; special function registers
                             30 ;--------------------------------------------------------
                             31 ;--------------------------------------------------------
                             32 ; ram data
                             33 ;--------------------------------------------------------
                             34 	.area _DATA
   0000                      35 _e4vm_vm_static:
   0000                      36 	.ds 719
   02CF                      37 _e4vm_vm:
   02CF                      38 	.ds 2
                             39 ;--------------------------------------------------------
                             40 ; ram data
                             41 ;--------------------------------------------------------
                             42 	.area _INITIALIZED
                             43 ;--------------------------------------------------------
                             44 ; absolute external ram data
                             45 ;--------------------------------------------------------
                             46 	.area _DABS (ABS)
                             47 ;--------------------------------------------------------
                             48 ; global & static initialisations
                             49 ;--------------------------------------------------------
                             50 	.area _HOME
                             51 	.area _GSINIT
                             52 	.area _GSFINAL
                             53 	.area _GSINIT
                             54 ;--------------------------------------------------------
                             55 ; Home
                             56 ;--------------------------------------------------------
                             57 	.area _HOME
                             58 	.area _HOME
                             59 ;--------------------------------------------------------
                             60 ; code
                             61 ;--------------------------------------------------------
                             62 	.area _CODE
                             63 ;e4vm.c:22: static void e4vm_do_hello (e4vm_type_x4thPtr *v)
                             64 ;	---------------------------------
                             65 ; Function e4vm_do_hello
                             66 ; ---------------------------------
   0000                      67 _e4vm_do_hello:
   0000 CDr00r00      [17]   68 	call	___sdcc_enter_ix
                             69 ;e4vm.c:24: (*v)->mem[30] = 1;
   0003 DD 6E 04      [19]   70 	ld	l, 4 (ix)
   0006 DD 66 05      [19]   71 	ld	h, 5 (ix)
   0009 4E            [ 7]   72 	ld	c, (hl)
   000A 23            [ 6]   73 	inc	hl
   000B 46            [ 7]   74 	ld	b, (hl)
   000C 21 C6 00      [10]   75 	ld	hl, #0x00c6
   000F 09            [11]   76 	add	hl, bc
   0010 36 01         [10]   77 	ld	(hl), #0x01
   0012 23            [ 6]   78 	inc	hl
   0013 36 00         [10]   79 	ld	(hl), #0x00
                             80 ;e4vm.c:25: }
   0015 DD E1         [14]   81 	pop	ix
   0017 C9            [10]   82 	ret
                             83 ;e4vm.c:27: static void e4vm_test1 (e4vm_type_x4thPtr *v)
                             84 ;	---------------------------------
                             85 ; Function e4vm_test1
                             86 ; ---------------------------------
   0018                      87 _e4vm_test1:
   0018 CDr00r00      [17]   88 	call	___sdcc_enter_ix
   001B 21 C0 FF      [10]   89 	ld	hl, #-64
   001E 39            [11]   90 	add	hl, sp
   001F F9            [ 6]   91 	ld	sp, hl
                             92 ;e4vm.c:37: Console_WriteStr((CHAR*)"e4vm_core test1 ", 17);
   0020 21rC0r01      [10]   93 	ld	hl, #___str_0
   0023 CDr00r00      [17]   94 	call	_Console_WriteStr_C_COMPACT
                             95 ;e4vm.c:38: e4vm_utils_init(v);
   0026 DD 6E 04      [19]   96 	ld	l, 4 (ix)
   0029 DD 66 05      [19]   97 	ld	h, 5 (ix)
   002C E5            [11]   98 	push	hl
   002D CDr00r00      [17]   99 	call	_e4vm_utils_init
   0030 F1            [10]  100 	pop	af
                            101 ;e4vm.c:39: e4vm_core_add_core_words(v);
   0031 DD 6E 04      [19]  102 	ld	l, 4 (ix)
   0034 DD 66 05      [19]  103 	ld	h, 5 (ix)
   0037 E5            [11]  104 	push	hl
   0038 CDr00r00      [17]  105 	call	_e4vm_core_add_core_words
   003B F1            [10]  106 	pop	af
                            107 ;e4vm.c:40: __MOVE((CHAR*)"hello", _str__10, 6);
   003C 21 00 00      [10]  108 	ld	hl, #0
   003F 39            [11]  109 	add	hl, sp
   0040 EB            [ 4]  110 	ex	de, hl
   0041 4B            [ 4]  111 	ld	c, e
   0042 42            [ 4]  112 	ld	b, d
   0043 D5            [11]  113 	push	de
   0044 21 06 00      [10]  114 	ld	hl, #0x0006
   0047 E5            [11]  115 	push	hl
   0048 21rD1r01      [10]  116 	ld	hl, #___str_1
   004B E5            [11]  117 	push	hl
   004C C5            [11]  118 	push	bc
   004D CDr00r00      [17]  119 	call	_memcpy
   0050 F1            [10]  120 	pop	af
   0051 F1            [10]  121 	pop	af
   0052 F1            [10]  122 	pop	af
   0053 D1            [10]  123 	pop	de
                            124 ;e4vm.c:41: e4vm_utils_add_core_word(v, (void*)_str__10, e4vm_do_hello, 0);
   0054 AF            [ 4]  125 	xor	a, a
   0055 F5            [11]  126 	push	af
   0056 33            [ 6]  127 	inc	sp
   0057 21r00r00      [10]  128 	ld	hl, #_e4vm_do_hello
   005A E5            [11]  129 	push	hl
   005B D5            [11]  130 	push	de
   005C DD 6E 04      [19]  131 	ld	l, 4 (ix)
   005F DD 66 05      [19]  132 	ld	h, 5 (ix)
   0062 E5            [11]  133 	push	hl
   0063 CDr00r00      [17]  134 	call	_e4vm_utils_add_core_word
   0066 F1            [10]  135 	pop	af
   0067 F1            [10]  136 	pop	af
   0068 F1            [10]  137 	pop	af
   0069 33            [ 6]  138 	inc	sp
                            139 ;e4vm.c:42: __MOVE((CHAR*)"dolist", _str__9, 7);
   006A 21 08 00      [10]  140 	ld	hl, #8
   006D 39            [11]  141 	add	hl, sp
   006E EB            [ 4]  142 	ex	de, hl
   006F 4B            [ 4]  143 	ld	c, e
   0070 42            [ 4]  144 	ld	b, d
   0071 D5            [11]  145 	push	de
   0072 21 07 00      [10]  146 	ld	hl, #0x0007
   0075 E5            [11]  147 	push	hl
   0076 21rD7r01      [10]  148 	ld	hl, #___str_2
   0079 E5            [11]  149 	push	hl
   007A C5            [11]  150 	push	bc
   007B CDr00r00      [17]  151 	call	_memcpy
   007E F1            [10]  152 	pop	af
   007F F1            [10]  153 	pop	af
   0080 F1            [10]  154 	pop	af
   0081 DD 6E 04      [19]  155 	ld	l, 4 (ix)
   0084 DD 66 05      [19]  156 	ld	h, 5 (ix)
   0087 E5            [11]  157 	push	hl
   0088 CDr00r00      [17]  158 	call	_e4vm_utils_add_op_from_string
   008B F1            [10]  159 	pop	af
   008C F1            [10]  160 	pop	af
                            161 ;e4vm.c:44: __MOVE((CHAR*)"hello", _str__8, 6);
   008D 21 10 00      [10]  162 	ld	hl, #16
   0090 39            [11]  163 	add	hl, sp
   0091 EB            [ 4]  164 	ex	de, hl
   0092 4B            [ 4]  165 	ld	c, e
   0093 42            [ 4]  166 	ld	b, d
   0094 D5            [11]  167 	push	de
   0095 21 06 00      [10]  168 	ld	hl, #0x0006
   0098 E5            [11]  169 	push	hl
   0099 21rD1r01      [10]  170 	ld	hl, #___str_1
   009C E5            [11]  171 	push	hl
   009D C5            [11]  172 	push	bc
   009E CDr00r00      [17]  173 	call	_memcpy
   00A1 F1            [10]  174 	pop	af
   00A2 F1            [10]  175 	pop	af
   00A3 F1            [10]  176 	pop	af
   00A4 DD 6E 04      [19]  177 	ld	l, 4 (ix)
   00A7 DD 66 05      [19]  178 	ld	h, 5 (ix)
   00AA E5            [11]  179 	push	hl
   00AB CDr00r00      [17]  180 	call	_e4vm_utils_add_op_from_string
   00AE F1            [10]  181 	pop	af
   00AF F1            [10]  182 	pop	af
                            183 ;e4vm.c:46: __MOVE((CHAR*)"exit", _str__7, 5);
   00B0 21 18 00      [10]  184 	ld	hl, #24
   00B3 39            [11]  185 	add	hl, sp
   00B4 EB            [ 4]  186 	ex	de, hl
   00B5 4B            [ 4]  187 	ld	c, e
   00B6 42            [ 4]  188 	ld	b, d
   00B7 D5            [11]  189 	push	de
   00B8 21 05 00      [10]  190 	ld	hl, #0x0005
   00BB E5            [11]  191 	push	hl
   00BC 21rDEr01      [10]  192 	ld	hl, #___str_3
   00BF E5            [11]  193 	push	hl
   00C0 C5            [11]  194 	push	bc
   00C1 CDr00r00      [17]  195 	call	_memcpy
   00C4 F1            [10]  196 	pop	af
   00C5 F1            [10]  197 	pop	af
   00C6 F1            [10]  198 	pop	af
   00C7 DD 6E 04      [19]  199 	ld	l, 4 (ix)
   00CA DD 66 05      [19]  200 	ld	h, 5 (ix)
   00CD E5            [11]  201 	push	hl
   00CE CDr00r00      [17]  202 	call	_e4vm_utils_add_op_from_string
   00D1 F1            [10]  203 	pop	af
   00D2 F1            [10]  204 	pop	af
                            205 ;e4vm.c:48: __MOVE((CHAR*)"dolist", _str__6, 7);
   00D3 21 20 00      [10]  206 	ld	hl, #32
   00D6 39            [11]  207 	add	hl, sp
   00D7 EB            [ 4]  208 	ex	de, hl
   00D8 4B            [ 4]  209 	ld	c, e
   00D9 42            [ 4]  210 	ld	b, d
   00DA D5            [11]  211 	push	de
   00DB 21 07 00      [10]  212 	ld	hl, #0x0007
   00DE E5            [11]  213 	push	hl
   00DF 21rD7r01      [10]  214 	ld	hl, #___str_2
   00E2 E5            [11]  215 	push	hl
   00E3 C5            [11]  216 	push	bc
   00E4 CDr00r00      [17]  217 	call	_memcpy
   00E7 F1            [10]  218 	pop	af
   00E8 F1            [10]  219 	pop	af
   00E9 F1            [10]  220 	pop	af
   00EA DD 6E 04      [19]  221 	ld	l, 4 (ix)
   00ED DD 66 05      [19]  222 	ld	h, 5 (ix)
   00F0 E5            [11]  223 	push	hl
   00F1 CDr00r00      [17]  224 	call	_e4vm_utils_add_op_from_string
   00F4 F1            [10]  225 	pop	af
   00F5 F1            [10]  226 	pop	af
                            227 ;e4vm.c:50: __MOVE((CHAR*)"nop", _str__5, 4);
   00F6 21 28 00      [10]  228 	ld	hl, #40
   00F9 39            [11]  229 	add	hl, sp
   00FA EB            [ 4]  230 	ex	de, hl
   00FB 4B            [ 4]  231 	ld	c, e
   00FC 42            [ 4]  232 	ld	b, d
   00FD D5            [11]  233 	push	de
   00FE 21 04 00      [10]  234 	ld	hl, #0x0004
   0101 E5            [11]  235 	push	hl
   0102 21rE3r01      [10]  236 	ld	hl, #___str_4
   0105 E5            [11]  237 	push	hl
   0106 C5            [11]  238 	push	bc
   0107 CDr00r00      [17]  239 	call	_memcpy
   010A F1            [10]  240 	pop	af
   010B F1            [10]  241 	pop	af
   010C F1            [10]  242 	pop	af
   010D DD 6E 04      [19]  243 	ld	l, 4 (ix)
   0110 DD 66 05      [19]  244 	ld	h, 5 (ix)
   0113 E5            [11]  245 	push	hl
   0114 CDr00r00      [17]  246 	call	_e4vm_utils_add_op_from_string
   0117 F1            [10]  247 	pop	af
                            248 ;e4vm.c:52: e4vm_utils_add_op(v, 4);
   0118 21 04 00      [10]  249 	ld	hl, #0x0004
   011B E3            [19]  250 	ex	(sp),hl
   011C DD 6E 04      [19]  251 	ld	l, 4 (ix)
   011F DD 66 05      [19]  252 	ld	h, 5 (ix)
   0122 E5            [11]  253 	push	hl
   0123 CDr00r00      [17]  254 	call	_e4vm_utils_add_op
   0126 F1            [10]  255 	pop	af
   0127 F1            [10]  256 	pop	af
                            257 ;e4vm.c:53: __MOVE((CHAR*)"nop", _str__4, 4);
   0128 21 30 00      [10]  258 	ld	hl, #48
   012B 39            [11]  259 	add	hl, sp
   012C EB            [ 4]  260 	ex	de, hl
   012D 4B            [ 4]  261 	ld	c, e
   012E 42            [ 4]  262 	ld	b, d
   012F D5            [11]  263 	push	de
   0130 21 04 00      [10]  264 	ld	hl, #0x0004
   0133 E5            [11]  265 	push	hl
   0134 21rE3r01      [10]  266 	ld	hl, #___str_4
   0137 E5            [11]  267 	push	hl
   0138 C5            [11]  268 	push	bc
   0139 CDr00r00      [17]  269 	call	_memcpy
   013C F1            [10]  270 	pop	af
   013D F1            [10]  271 	pop	af
   013E F1            [10]  272 	pop	af
   013F DD 6E 04      [19]  273 	ld	l, 4 (ix)
   0142 DD 66 05      [19]  274 	ld	h, 5 (ix)
   0145 E5            [11]  275 	push	hl
   0146 CDr00r00      [17]  276 	call	_e4vm_utils_add_op_from_string
   0149 F1            [10]  277 	pop	af
   014A F1            [10]  278 	pop	af
                            279 ;e4vm.c:55: __MOVE((CHAR*)"exit", _str__3, 5);
   014B 21 38 00      [10]  280 	ld	hl, #56
   014E 39            [11]  281 	add	hl, sp
   014F EB            [ 4]  282 	ex	de, hl
   0150 4B            [ 4]  283 	ld	c, e
   0151 42            [ 4]  284 	ld	b, d
   0152 D5            [11]  285 	push	de
   0153 21 05 00      [10]  286 	ld	hl, #0x0005
   0156 E5            [11]  287 	push	hl
   0157 21rDEr01      [10]  288 	ld	hl, #___str_3
   015A E5            [11]  289 	push	hl
   015B C5            [11]  290 	push	bc
   015C CDr00r00      [17]  291 	call	_memcpy
   015F F1            [10]  292 	pop	af
   0160 F1            [10]  293 	pop	af
   0161 F1            [10]  294 	pop	af
   0162 DD 6E 04      [19]  295 	ld	l, 4 (ix)
   0165 DD 66 05      [19]  296 	ld	h, 5 (ix)
   0168 E5            [11]  297 	push	hl
   0169 CDr00r00      [17]  298 	call	_e4vm_utils_add_op_from_string
   016C F1            [10]  299 	pop	af
   016D F1            [10]  300 	pop	af
                            301 ;e4vm.c:57: (*v)->wp = 8;
   016E DD 4E 04      [19]  302 	ld	c, 4 (ix)
   0171 DD 46 05      [19]  303 	ld	b, 5 (ix)
   0174 69            [ 4]  304 	ld	l, c
   0175 60            [ 4]  305 	ld	h, b
   0176 5E            [ 7]  306 	ld	e, (hl)
   0177 23            [ 6]  307 	inc	hl
   0178 56            [ 7]  308 	ld	d, (hl)
   0179 13            [ 6]  309 	inc	de
   017A 13            [ 6]  310 	inc	de
   017B 62            [ 4]  311 	ld	h, d
   017C 6B            [ 4]  312 	ld	l, e
   017D 36 08         [10]  313 	ld	(hl), #0x08
   017F 23            [ 6]  314 	inc	hl
   0180 36 00         [10]  315 	ld	(hl), #0x00
                            316 ;e4vm.c:58: e4vm_core_do_list(v);
   0182 C5            [11]  317 	push	bc
   0183 C5            [11]  318 	push	bc
   0184 CDr00r00      [17]  319 	call	_e4vm_core_do_list
   0187 F1            [10]  320 	pop	af
   0188 DD 6E 04      [19]  321 	ld	l, 4 (ix)
   018B DD 66 05      [19]  322 	ld	h, 5 (ix)
   018E E5            [11]  323 	push	hl
   018F CDr00r00      [17]  324 	call	_e4vm_core_do_next
   0192 F1            [10]  325 	pop	af
                            326 ;e4vm.c:60: if ((*v)->mem[30] == 1) {
   0193 E1            [10]  327 	pop	hl
   0194 4E            [ 7]  328 	ld	c, (hl)
   0195 23            [ 6]  329 	inc	hl
   0196 66            [ 7]  330 	ld	h, (hl)
   0197 69            [ 4]  331 	ld	l, c
   0198 11 C6 00      [10]  332 	ld	de, #0x00c6
   019B 19            [11]  333 	add	hl, de
   019C 4E            [ 7]  334 	ld	c, (hl)
   019D 23            [ 6]  335 	inc	hl
   019E 46            [ 7]  336 	ld	b, (hl)
   019F 79            [ 4]  337 	ld	a, c
   01A0 3D            [ 4]  338 	dec	a
   01A1 B0            [ 4]  339 	or	a, b
   01A2 20 08         [12]  340 	jr	NZ,00102$
                            341 ;e4vm.c:61: Console_WriteStr((CHAR*)" - ok", 6);
   01A4 21rE7r01      [10]  342 	ld	hl, #___str_5
   01A7 CDr00r00      [17]  343 	call	_Console_WriteStr_C_COMPACT
   01AA 18 06         [12]  344 	jr	00103$
   01AC                     345 00102$:
                            346 ;e4vm.c:63: Console_WriteStr((CHAR*)" - error", 9);
   01AC 21rEDr01      [10]  347 	ld	hl, #___str_6
   01AF CDr00r00      [17]  348 	call	_Console_WriteStr_C_COMPACT
   01B2                     349 00103$:
                            350 ;e4vm.c:65: Console_WriteStrLn((CHAR*)" ", 2);
   01B2 21rF6r01      [10]  351 	ld	hl, #___str_7
   01B5 CDr00r00      [17]  352 	call	_Console_WriteStr_C_COMPACT
   01B8 CDr00r00      [17]  353 	call	_Console_WriteLn_COMPACT
                            354 ;e4vm.c:66: }
   01BB DD F9         [10]  355 	ld	sp, ix
   01BD DD E1         [14]  356 	pop	ix
   01BF C9            [10]  357 	ret
   01C0                     358 ___str_0:
   01C0 65 34 76 6D 5F 63   359 	.ascii "e4vm_core test1 "
        6F 72 65 20 74 65
        73 74 31 20
   01D0 00                  360 	.db 0x00
   01D1                     361 ___str_1:
   01D1 68 65 6C 6C 6F      362 	.ascii "hello"
   01D6 00                  363 	.db 0x00
   01D7                     364 ___str_2:
   01D7 64 6F 6C 69 73 74   365 	.ascii "dolist"
   01DD 00                  366 	.db 0x00
   01DE                     367 ___str_3:
   01DE 65 78 69 74         368 	.ascii "exit"
   01E2 00                  369 	.db 0x00
   01E3                     370 ___str_4:
   01E3 6E 6F 70            371 	.ascii "nop"
   01E6 00                  372 	.db 0x00
   01E7                     373 ___str_5:
   01E7 20 2D 20 6F 6B      374 	.ascii " - ok"
   01EC 00                  375 	.db 0x00
   01ED                     376 ___str_6:
   01ED 20 2D 20 65 72 72   377 	.ascii " - error"
        6F 72
   01F5 00                  378 	.db 0x00
   01F6                     379 ___str_7:
   01F6 20                  380 	.ascii " "
   01F7 00                  381 	.db 0x00
                            382 ;e4vm.c:69: int main (int argc, char **argv)
                            383 ;	---------------------------------
                            384 ; Function main
                            385 ; ---------------------------------
   01F8                     386 _main::
                            387 ;e4vm.c:74: __IMPORT(e4vm_core__init);
   01F8 CDr00r00      [17]  388 	call	_e4vm_core__init
                            389 ;e4vm.c:75: __IMPORT(e4vm_type__init);
   01FB CDr00r00      [17]  390 	call	_e4vm_type__init
                            391 ;e4vm.c:76: __IMPORT(e4vm_utils__init);
   01FE CDr00r00      [17]  392 	call	_e4vm_utils__init
                            393 ;e4vm.c:79: Basic_Init();
   0201 FD CB 01 A6   [23]  394 	res	4,1(iy) 
   0205 CD 42 16      [17]  395 	call 0x1642 
                            396 ;e4vm.c:80: Console_Clear(7);
   0208 2E 07         [ 7]  397 	ld	l, #0x07
   020A CDr00r00      [17]  398 	call	_Console_Clear_COMPACT
                            399 ;e4vm.c:81: Console_SetColors(56);
   020D 21r00r00      [10]  400 	ld	hl, #_Console_attrib
   0210 36 38         [10]  401 	ld	(hl), #0x38
                            402 ;e4vm.c:82: e4vm_vm = (e4vm_type_x4thPtr)((SYSTEM_ADRINT)&e4vm_vm_static);
   0212 21r00r00      [10]  403 	ld	hl, #_e4vm_vm_static
   0215 22rCFr02      [16]  404 	ld	(_e4vm_vm), hl
                            405 ;e4vm.c:83: e4vm_test1(&e4vm_vm);
   0218 21rCFr02      [10]  406 	ld	hl, #_e4vm_vm
   021B E5            [11]  407 	push	hl
   021C CDr18r00      [17]  408 	call	_e4vm_test1
   021F F1            [10]  409 	pop	af
                            410 ;e4vm.c:84: Basic_PAUSE(0);
   0220 21 00 00      [10]  411 	ld	hl, #0x0000
   0223 CDr00r00      [17]  412 	call	_Basic_PAUSE_EI
                            413 ;e4vm.c:85: Basic_Quit();
                            414 ;e4vm.c:86: __FINI;
                            415 ;e4vm.c:87: }
   0226 C3r00r00      [10]  416 	jp  _Basic_Quit_IM1
                            417 	.area _CODE
                            418 	.area _INITIALIZER
                            419 	.area _CABS (ABS)
